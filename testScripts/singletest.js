// Script: 'testtwo.js' , generated by Gamedonia
describe("Gamedonia test environments", function() {
    
    var env=null;
    var user = null;
	var session = null;

    beforeAll(function() {
          env = gamedonia.createTestEnvironment();
    	// we create a user
    	user = env.createUser({name:'Not Alberto', lastname:'Not Xaubet', age:80});

    	// and log him in
    	session = user.login();
    });
     
     afterAll(function() {
    	 
        session.logout();
        user = null;
        session = null;
        env.destroy();
        env=null;
        
        
    });
	    
    it("run custom scripts", function(){
    	
    	var rankingsCount = session.count("rankings", "{}");
    	expect(rankingsCount.isOk()).toBe(true);
    	expect(rankingsCount.getResult().count).toBe(0);
    	
    	var scriptResult = session.run("addranking",{});
    	if(scriptResult.isOk()) {
    		
    		var result = scriptResult.getResult();
    		expect(result).not.toBeUndefined();
    	}
    	
    	rankingsCount = session.count("rankings", "{}");
		expect(rankingsCount.isOk()).toBe(true);
		expect(rankingsCount.getResult().count).toBe(1);
    });
});